---
allowed-tools: Read, Grep, mcp__sequential-thinking__sequentialthinking
argument-hint: [workflow-core-json] [project-context-json]
description: Detect project ecosystem and technology stack
---

# Project Ecosystem Detection

## Chain Position: 3.5a/7 (Ecosystem Detection)

**Input**: Workflow core + project context files
**Output**: Populated project-context.json with detected ecosystem and technology stack

## CRITICAL REQUIREMENT

<fail_fast_implementation>
STEP 1: MANDATORY - Modular Workflow Validation

1. Load workflow-core.json from $1
2. IF file does not exist THEN:
   - Display error: "❌ Workflow core file missing"
   - Display fix: "Run: /dt:workflow:01-analyze-prd [prd-file] first"
   - EXIT IMMEDIATELY
3. Load or create project-context.json from $2
4. IF project context path is invalid THEN:
   - Display error: "❌ Project context file path invalid"
   - Display fix: "Ensure project-context.json path is correct"
   - EXIT IMMEDIATELY
5. Get current working directory as project path
6. ONLY if validation passes THEN proceed to Step 2
</fail_fast_implementation>

## Instructions

**CRITICAL REQUIREMENT - NEXT COMMAND DISPLAY**
You MUST display the complete next task command at the end of execution in the exact format:
`/0x-<command-name> <param1> <param2> <...>`

NEVER provide brief notifications like "You can run /0x-<command> now."
ALWAYS show the complete command with all parameters filled in.
This is NON-NEGOTIABLE and MANDATORY for workflow progression.

<expertise_definition>
You are a technology stack detection specialist with expertise in:

- Universal project type detection across all programming languages and frameworks
- Project complexity assessment and size classification
- File pattern recognition and dependency analysis
- Cross-platform ecosystem identification
</expertise_definition>

<execution_process>

### Step 2: MANDATORY - Technology Stack Detection

<ecosystem_detection>
**BLOCKING VALIDATION**: Project must have detectable technology stack

1. **Language Detection**:
   - Scan project directory for primary language indicators:
     - package.json → Node.js/JavaScript
     - requirements.txt/pyproject.toml → Python
     - pom.xml/build.gradle → Java
     - Cargo.toml → Rust
     - go.mod → Go
     - composer.json → PHP
     - Gemfile → Ruby
     - *.csproj → C#/.NET
     - CMakeLists.txt/Makefile → C/C++

2. **Framework Detection**:
   - Parse dependency files for framework indicators
   - Detect based on file structure patterns
   - Identify testing frameworks and build tools

3. **Validation**:
   - IF no primary language detected THEN:
     - Display error: "❌ Unable to detect project technology stack"
     - Display fix: "Ensure project has standard dependency files"
     - EXIT IMMEDIATELY
   - IF detection successful THEN proceed to Step 3
</ecosystem_detection>

### Step 3: MANDATORY - Project Complexity Assessment

<complexity_assessment>

1. **Size Classification**:
   - Count total files in project
   - Estimate lines of code
   - Count dependencies
   - Classify as: Small/Medium/Large/Enterprise

2. **Essential Tools Identification**:
   - Package manager (npm, pip, gradle, cargo, etc.)
   - Build system (if applicable)
   - Primary testing framework
   - Basic linting tools

3. **Output Validation**:
   - IF complexity cannot be determined THEN:
     - Display error: "❌ Project complexity assessment failed"
     - Display fix: "Ensure project structure is readable"
     - EXIT IMMEDIATELY
   - IF assessment successful THEN proceed to Step 4
</complexity_assessment>

### Step 4: MANDATORY - Update Workflow JSON

<workflow_update>

1. **Enhance project-context.json** with detected ecosystem data:

   ```json
   {
     "ecosystem": {
       "primary_language": "detected_language",
       "frameworks": ["detected_frameworks"],
       "complexity": "Small|Medium|Large|Enterprise",
       "essential_tools": {
         "package_manager": "tool_name",
         "build_system": "tool_name_or_null",
         "testing_framework": "detected_test_framework",
         "linter": "detected_linter"
       },
       "detection_status": "complete"
     }
   }
   ```

2. **Write updated JSON** to project-context.json file
3. **Update relationships.json** with ecosystem cross-references

3. **Validation**:
   - IF write fails THEN:
     - Display error: "❌ Failed to update workflow JSON"
     - Display fix: "Check file permissions and disk space"
     - EXIT IMMEDIATELY
   - IF successful THEN display success message
</workflow_update>

</execution_process>

## Output Requirements

**SUCCESS CRITERIA**:

- ✅ Primary language detected and documented
- ✅ Essential tools identified for detected ecosystem
- ✅ Project complexity classified
- ✅ Workflow JSON enhanced with ecosystem data
- ✅ detection_status set to "complete"

**FAILURE HANDLING**:

- Any detection failure MUST result in immediate exit
- All failures MUST provide specific remediation guidance
- No partial detection results allowed

**MANDATORY - DISPLAY THIS EXACT COMMAND:**

```
/03.5b-research-standards ./.workflow/core/workflow-core.json ./.workflow/context/project-context.json
```

**CRITICAL**: You MUST display the above command exactly as shown. Do NOT provide brief notifications or summaries.

## Usage

```bash
Detect ecosystem using:
- Workflow core: ${1:?"workflow-core.json path required"}
- Project context: ${2:?"project-context.json path required"}
```

**MANDATORY FINAL REQUIREMENT:**
You MUST conclude by displaying the complete next command in this exact format:

```
/03.5b-research-standards ./.workflow/core/workflow-core.json ./.workflow/context/project-context.json
```

This is NON-NEGOTIABLE. Brief notifications are insufficient and will break the workflow.
